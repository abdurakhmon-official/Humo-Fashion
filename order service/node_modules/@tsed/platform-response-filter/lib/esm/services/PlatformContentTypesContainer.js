import { constant, inject, injectable } from "@tsed/di";
import { ContentTypes } from "../constants/ContentTypes.js";
import { ResponseFiltersContainer } from "../domain/ResponseFiltersContainer.js";
export const PLATFORM_CONTENT_TYPES_CONTAINER = injectable(Symbol.for("PLATFORM_CONTENT_TYPES_CONTAINER"))
    .factory(() => {
    const responseFilters = constant("responseFilters", []);
    const containers = new Map();
    ResponseFiltersContainer.forEach((token, type) => {
        if (responseFilters.includes(token)) {
            containers.set(type, token);
        }
    });
    return {
        contentTypes: [...containers.keys()],
        resolve(bestContentType) {
            const token = containers.get(bestContentType) || containers.get(ContentTypes.ANY);
            if (token) {
                return inject(token);
            }
        }
    };
})
    .token();
